2025-10-26 08:21:21,459 - mcp.server.lowlevel.server - DEBUG - Initializing server 'CRM Server'
2025-10-26 08:21:21,459 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListToolsRequest
2025-10-26 08:21:21,460 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListResourcesRequest
2025-10-26 08:21:21,460 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListResourceTemplatesRequest
2025-10-26 08:21:21,460 - mcp.server.lowlevel.server - DEBUG - Registering handler for PromptListRequest
2025-10-26 08:21:21,460 - mcp.server.lowlevel.server - DEBUG - Registering handler for CallToolRequest
2025-10-26 08:21:21,460 - mcp.server.lowlevel.server - DEBUG - Registering handler for ReadResourceRequest
2025-10-26 08:21:21,461 - mcp.server.lowlevel.server - DEBUG - Registering handler for GetPromptRequest
2025-10-26 08:21:21,526 - mcp.server.streamable_http_manager - INFO - StreamableHTTP session manager started
2025-10-26 08:21:47,847 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:21:47,848 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 539d557d3d774e25b6a21a6c98bf5691
2025-10-26 08:21:47,857 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:21:47,857 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:21:47,858 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:21:48,429 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:21:48,430 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:21:48,787 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:21:48,997 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:21:48,998 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4486720>
2025-10-26 08:21:48,999 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:21:48,999 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:21:49,000 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:21:49,000 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:21:49,000 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:21:49,001 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:21:50,642 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:21:50,643 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44a2c00>
2025-10-26 08:21:50,644 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:21:50,644 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:21:50,649 - server_module - INFO - ================================================================================
2025-10-26 08:21:50,649 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:21:50,649 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:21:50,650 - server_module - INFO -    correo: None
2025-10-26 08:21:50,650 - server_module - INFO -    usuario: None
2025-10-26 08:21:50,650 - server_module - INFO - ================================================================================
2025-10-26 08:21:50,654 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-10-26 08:21:51,127 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-10-26 08:21:51,129 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-10-26 08:21:52,167 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:21:52,501 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:21:52,986 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:21:52,987 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:21:52,990 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:21:52,991 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:21:52,991 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:21:52,992 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:21:54,300 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:21:54,301 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:23:34,692 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:23:34,693 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: c24d9d1544ec43ceb68a7092ccf52707
2025-10-26 08:23:34,697 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:23:34,698 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:23:34,698 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:23:35,389 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:23:35,392 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:23:35,730 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:23:35,949 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:23:35,951 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44a0bc0>
2025-10-26 08:23:35,951 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:23:35,951 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:23:35,952 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:23:35,952 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:23:35,953 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:23:35,953 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:23:39,964 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:23:39,965 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:23:39,968 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44da9f0>
2025-10-26 08:23:39,970 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:23:39,970 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:23:39,996 - server_module - INFO - ================================================================================
2025-10-26 08:23:39,997 - server_module - INFO - üîÑ LLAMADA A update_client
2025-10-26 08:23:39,997 - server_module - INFO -    client_id: tEbHFy
2025-10-26 08:23:39,997 - server_module - INFO -    nombre: Fernando
2025-10-26 08:23:39,997 - server_module - INFO -    telefono: None
2025-10-26 08:23:39,997 - server_module - INFO -    correo: None
2025-10-26 08:23:39,997 - server_module - INFO -    tipo: None
2025-10-26 08:23:39,997 - server_module - INFO -    estado: None
2025-10-26 08:23:39,997 - server_module - INFO -    nota: None
2025-10-26 08:23:39,997 - server_module - INFO -    usuario: None
2025-10-26 08:23:39,997 - server_module - INFO -    fecha_conversion: None
2025-10-26 08:23:39,998 - server_module - INFO - ================================================================================
2025-10-26 08:23:40,427 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:23:40,760 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:23:41,224 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:23:41,699 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21B3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:23:41,700 - server_module - INFO - üì§ RESPUESTA update_client: {'success': True, 'client_id': 'tEbHFy', 'updated_fields': ['Nombre'], 'message': 'Cliente actualizado: 1 campos modificados'}
2025-10-26 08:23:41,703 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:23:41,704 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44a3110>
2025-10-26 08:23:41,704 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:23:41,705 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:23:41,713 - server_module - INFO - ================================================================================
2025-10-26 08:23:41,714 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:23:41,714 - server_module - INFO -    telefono: 573146964611
2025-10-26 08:23:41,714 - server_module - INFO -    correo: None
2025-10-26 08:23:41,714 - server_module - INFO -    usuario: None
2025-10-26 08:23:41,714 - server_module - INFO - ================================================================================
2025-10-26 08:23:41,964 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:23:42,271 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:23:42,553 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:23:42,554 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': True, 'client_id': 'tEbHFy', 'nombre': 'Fernando', 'telefono': 573146964611, 'correo': 'fordezdeveloper2@gmail.com', 'tipo': 'Lead', 'estado': 'Nuevo', 'canal': 'whatsapp', 'nota': '', 'usuario': 'Fordez', 'matched_by': 'telefono'}
2025-10-26 08:23:42,555 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:23:42,556 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:23:42,556 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":true,\\"client_id\\":\\"tEbHFy\\",\\"updated_fields\\":[\\"Nombre\\"],\\"message\\":\\"Cliente actualizado: 1 campos modificados\\"}"}],"structuredContent":{"success":true,"client_id":"tEbHFy","updated_fields":["Nombre"],"message":"Cliente actualizado: 1 campos modificados"},"isError":false}}\r\n\r\n'
2025-10-26 08:23:42,556 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:23:42,557 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":true,\\"client_id\\":\\"tEbHFy\\",\\"nombre\\":\\"Fernando\\",\\"telefono\\":573146964611,\\"correo\\":\\"fordezdeveloper2@gmail.com\\",\\"tipo\\":\\"Lead\\",\\"estado\\":\\"Nuevo\\",\\"canal\\":\\"whatsapp\\",\\"nota\\":\\"\\",\\"usuario\\":\\"Fordez\\",\\"matched_by\\":\\"telefono\\"}"}],"structuredContent":{"exists":true,"client_id":"tEbHFy","nombre":"Fernando","telefono":573146964611,"correo":"fordezdeveloper2@gmail.com","tipo":"Lead","estado":"Nuevo","canal":"whatsapp","nota":"","usuario":"Fordez","matched_by":"telefono"},"isError":false}}\r\n\r\n'
2025-10-26 08:23:42,557 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:23:42,557 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:23:44,167 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:23:44,168 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:24:25,155 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:24:25,155 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 2e0d9dfe9bb940bfba5f8635e67a8241
2025-10-26 08:24:25,159 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:24:25,159 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:24:25,160 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:24:25,771 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:24:25,774 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:24:26,110 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:24:26,343 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:24:26,346 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f450c3b0>
2025-10-26 08:24:26,346 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:24:26,346 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:24:26,347 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:24:26,348 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:24:26,348 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:24:26,349 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:24:28,163 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:24:28,164 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:24:28,166 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f450c380>
2025-10-26 08:24:28,167 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:24:28,168 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:24:28,181 - server_module - INFO - ================================================================================
2025-10-26 08:24:28,181 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:24:28,182 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:24:28,182 - server_module - INFO -    correo: None
2025-10-26 08:24:28,182 - server_module - INFO -    usuario: None
2025-10-26 08:24:28,182 - server_module - INFO - ================================================================================
2025-10-26 08:24:28,561 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:24:28,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:24:29,151 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:24:29,154 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:24:29,156 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:24:29,157 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44f1220>
2025-10-26 08:24:29,157 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:24:29,157 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:24:29,173 - server_module - INFO - ================================================================================
2025-10-26 08:24:29,173 - server_module - INFO - üîÑ LLAMADA A update_client
2025-10-26 08:24:29,173 - server_module - INFO -    client_id: tEbHFy
2025-10-26 08:24:29,173 - server_module - INFO -    nombre: None
2025-10-26 08:24:29,173 - server_module - INFO -    telefono: None
2025-10-26 08:24:29,173 - server_module - INFO -    correo: fordeztest@gmail.com
2025-10-26 08:24:29,173 - server_module - INFO -    tipo: None
2025-10-26 08:24:29,173 - server_module - INFO -    estado: None
2025-10-26 08:24:29,174 - server_module - INFO -    nota: None
2025-10-26 08:24:29,174 - server_module - INFO -    usuario: None
2025-10-26 08:24:29,174 - server_module - INFO -    fecha_conversion: None
2025-10-26 08:24:29,174 - server_module - INFO - ================================================================================
2025-10-26 08:24:29,426 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:24:29,761 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:24:30,030 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:24:30,478 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21D3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:24:30,479 - server_module - INFO - üì§ RESPUESTA update_client: {'success': True, 'client_id': 'tEbHFy', 'updated_fields': ['Correo'], 'message': 'Cliente actualizado: 1 campos modificados'}
2025-10-26 08:24:30,482 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:24:30,482 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:24:30,482 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:24:30,483 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:24:30,484 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":true,\\"client_id\\":\\"tEbHFy\\",\\"updated_fields\\":[\\"Correo\\"],\\"message\\":\\"Cliente actualizado: 1 campos modificados\\"}"}],"structuredContent":{"success":true,"client_id":"tEbHFy","updated_fields":["Correo"],"message":"Cliente actualizado: 1 campos modificados"},"isError":false}}\r\n\r\n'
2025-10-26 08:24:30,485 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:24:30,486 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:24:31,854 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:24:31,855 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:32:56,819 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:32:56,820 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 15fca41d2f18470886b7806dab985863
2025-10-26 08:32:56,829 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:32:56,829 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:32:56,830 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:32:57,391 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:32:57,393 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:32:57,738 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:32:58,092 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:32:58,096 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f450f800>
2025-10-26 08:32:58,097 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:32:58,097 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:32:58,097 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:32:58,098 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:32:58,098 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:32:58,099 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:32:59,930 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:32:59,933 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f450ef90>
2025-10-26 08:32:59,934 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:32:59,935 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:32:59,941 - server_module - INFO - ================================================================================
2025-10-26 08:32:59,941 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:32:59,941 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:32:59,942 - server_module - INFO -    correo: None
2025-10-26 08:32:59,942 - server_module - INFO -    usuario: None
2025-10-26 08:32:59,942 - server_module - INFO - ================================================================================
2025-10-26 08:32:59,945 - urllib3.connectionpool - DEBUG - Resetting dropped connection: sheets.googleapis.com
2025-10-26 08:33:00,638 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:00,956 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:01,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:33:01,298 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:33:01,301 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:33:01,303 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:33:01,303 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:33:01,304 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:02,895 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:02,895 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:33:32,901 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:33:32,902 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 845518a67584479f88de7ba4676690fb
2025-10-26 08:33:32,911 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:33:32,912 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:33:32,913 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:33,616 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:33:33,617 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:33:33,960 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:33:34,182 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:33:34,184 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44a1670>
2025-10-26 08:33:34,184 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:33:34,184 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:33:34,184 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:33:34,185 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:33:34,185 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:33:34,186 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:35,645 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:33:35,648 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4516b70>
2025-10-26 08:33:35,649 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:33:35,649 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:33:35,658 - server_module - INFO - ================================================================================
2025-10-26 08:33:35,658 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:33:35,658 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:33:35,658 - server_module - INFO -    correo: None
2025-10-26 08:33:35,659 - server_module - INFO -    usuario: None
2025-10-26 08:33:35,659 - server_module - INFO - ================================================================================
2025-10-26 08:33:35,875 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:36,185 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:36,500 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:33:36,501 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:33:36,502 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:33:36,503 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:33:36,503 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:33:36,504 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:37,934 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:33:37,936 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4515eb0>
2025-10-26 08:33:37,936 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:33:37,936 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:33:37,952 - server_module - INFO - ================================================================================
2025-10-26 08:33:37,953 - server_module - INFO - ‚ú® LLAMADA A create_client
2025-10-26 08:33:37,953 - server_module - INFO -    nombre: Fernando
2025-10-26 08:33:37,953 - server_module - INFO -    canal: whatsapp
2025-10-26 08:33:37,953 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:33:37,953 - server_module - INFO -    correo: None
2025-10-26 08:33:37,953 - server_module - INFO -    nota: None
2025-10-26 08:33:37,953 - server_module - INFO -    usuario: Fordez
2025-10-26 08:33:37,953 - server_module - INFO - ================================================================================
2025-10-26 08:33:38,246 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:38,546 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:33:38,898 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:33:39,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21A3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:39,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21B3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:40,146 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21C3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:40,466 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21D3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:40,690 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21E3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:40,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21F3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:41,199 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21G3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:41,432 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21H3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:41,674 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21I3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:41,910 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21J3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:42,141 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21K3?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:33:42,142 - server_module - INFO - üì§ RESPUESTA create_client: {'success': True, 'client_id': 'f7CFYw', 'nombre': 'Fernando', 'canal': 'whatsapp', 'message': 'Cliente creado exitosamente'}
2025-10-26 08:33:42,144 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:33:42,145 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:33:42,145 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":true,\\"client_id\\":\\"f7CFYw\\",\\"nombre\\":\\"Fernando\\",\\"canal\\":\\"whatsapp\\",\\"message\\":\\"Cliente creado exitosamente\\"}"}],"structuredContent":{"success":true,"client_id":"f7CFYw","nombre":"Fernando","canal":"whatsapp","message":"Cliente creado exitosamente"},"isError":false}}\r\n\r\n'
2025-10-26 08:33:42,146 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:44,785 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:33:44,786 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:34:31,373 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:34:31,374 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: c499085ea6904004b1141a8f067b6ea0
2025-10-26 08:34:31,380 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:34:31,380 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:34:31,381 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:31,991 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:31,994 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:34:32,333 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:32,550 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:32,551 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44d85c0>
2025-10-26 08:34:32,551 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:34:32,551 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:34:32,552 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:34:32,552 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:34:32,553 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:34:32,553 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:33,835 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:33,837 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44f1f10>
2025-10-26 08:34:33,837 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:34:33,837 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:34:33,842 - server_module - INFO - ================================================================================
2025-10-26 08:34:33,842 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:34:33,842 - server_module - INFO -    telefono: 573146964611
2025-10-26 08:34:33,842 - server_module - INFO -    correo: None
2025-10-26 08:34:33,842 - server_module - INFO -    usuario: None
2025-10-26 08:34:33,842 - server_module - INFO - ================================================================================
2025-10-26 08:34:34,117 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:34:34,442 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:34:34,752 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:34:34,753 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': True, 'client_id': 'f7CFYw', 'nombre': 'Fernando', 'telefono': 573146964611, 'correo': '', 'tipo': 'Lead', 'estado': 'Nuevo', 'canal': 'whatsapp', 'nota': '', 'usuario': 'Fordez', 'matched_by': 'telefono'}
2025-10-26 08:34:34,755 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:34:34,755 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:34:34,756 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":true,\\"client_id\\":\\"f7CFYw\\",\\"nombre\\":\\"Fernando\\",\\"telefono\\":573146964611,\\"correo\\":\\"\\",\\"tipo\\":\\"Lead\\",\\"estado\\":\\"Nuevo\\",\\"canal\\":\\"whatsapp\\",\\"nota\\":\\"\\",\\"usuario\\":\\"Fordez\\",\\"matched_by\\":\\"telefono\\"}"}],"structuredContent":{"exists":true,"client_id":"f7CFYw","nombre":"Fernando","telefono":573146964611,"correo":"","tipo":"Lead","estado":"Nuevo","canal":"whatsapp","nota":"","usuario":"Fordez","matched_by":"telefono"},"isError":false}}\r\n\r\n'
2025-10-26 08:34:34,756 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:36,802 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:36,802 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:34:56,057 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:34:56,057 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 4854830d0382481ea5748d8ab6d0c41f
2025-10-26 08:34:56,061 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:34:56,062 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:34:56,062 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:56,672 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:56,674 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:34:57,013 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:57,286 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:34:57,288 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44d8e00>
2025-10-26 08:34:57,288 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:34:57,288 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:34:57,289 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:34:57,290 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:34:57,290 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:34:57,291 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:59,632 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:34:59,633 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:35:10,494 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:35:10,495 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: b4f0efceefea4ca78f56dc52440fdfc5
2025-10-26 08:35:10,503 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:35:10,503 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:35:10,504 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:11,280 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:11,281 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:35:11,695 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:11,948 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:11,949 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f44f2240>
2025-10-26 08:35:11,949 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:35:11,949 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:35:11,950 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:35:11,951 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:35:11,951 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:35:11,952 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:13,467 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:13,468 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:35:47,252 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:35:47,252 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 3c82af99777f4177bdeb30951f9d3619
2025-10-26 08:35:47,257 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:35:47,257 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:35:47,258 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:47,898 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:47,900 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:35:48,281 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:48,483 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:48,486 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f450d550>
2025-10-26 08:35:48,486 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:35:48,486 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:35:48,487 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:35:48,488 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:35:48,488 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:35:48,490 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:50,329 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:35:50,332 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4517170>
2025-10-26 08:35:50,332 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:35:50,332 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:35:50,347 - server_module - INFO - ================================================================================
2025-10-26 08:35:50,348 - server_module - INFO - üîÑ LLAMADA A update_client
2025-10-26 08:35:50,348 - server_module - INFO -    client_id: tEbHFy
2025-10-26 08:35:50,348 - server_module - INFO -    nombre: Fernando
2025-10-26 08:35:50,348 - server_module - INFO -    telefono: None
2025-10-26 08:35:50,348 - server_module - INFO -    correo: None
2025-10-26 08:35:50,349 - server_module - INFO -    tipo: None
2025-10-26 08:35:50,349 - server_module - INFO -    estado: None
2025-10-26 08:35:50,349 - server_module - INFO -    nota: Inter√©s en desarrollo web para aumentar ventas, cliente tipo empresa, sitio web: www.gh.com
2025-10-26 08:35:50,349 - server_module - INFO -    usuario: Fordez
2025-10-26 08:35:50,349 - server_module - INFO -    fecha_conversion: None
2025-10-26 08:35:50,350 - server_module - INFO - ================================================================================
2025-10-26 08:35:50,586 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:35:50,837 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:35:51,147 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:35:51,148 - server_module - INFO - üì§ RESPUESTA update_client: {'success': False, 'error': "Cliente con ID 'tEbHFy' no encontrado"}
2025-10-26 08:35:51,149 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:35:51,150 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:35:51,150 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"success\\":false,\\"error\\":\\"Cliente con ID \'tEbHFy\' no encontrado\\"}"}],"structuredContent":{"success":false,"error":"Cliente con ID \'tEbHFy\' no encontrado"},"isError":false}}\r\n\r\n'
2025-10-26 08:35:51,150 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:52,785 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:35:52,786 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:37:23,308 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:37:23,308 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 12ff05799b354692b9be42a75fcd3da0
2025-10-26 08:37:23,312 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:23,313 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:37:23,313 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:23,917 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:23,919 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:37:24,273 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:24,534 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:24,536 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4569a60>
2025-10-26 08:37:24,537 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:37:24,537 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:37:24,537 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:37:24,538 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:24,538 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:37:24,538 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:26,788 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:26,789 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:26,793 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f452c530>
2025-10-26 08:37:26,794 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:37:26,794 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:37:26,810 - server_module - INFO - ================================================================================
2025-10-26 08:37:26,810 - server_module - INFO - üîÑ LLAMADA A update_client
2025-10-26 08:37:26,810 - server_module - INFO -    client_id: tEbHFy
2025-10-26 08:37:26,810 - server_module - INFO -    nombre: None
2025-10-26 08:37:26,810 - server_module - INFO -    telefono: None
2025-10-26 08:37:26,810 - server_module - INFO -    correo: fordezdeveloper2@gmail.com
2025-10-26 08:37:26,810 - server_module - INFO -    tipo: None
2025-10-26 08:37:26,810 - server_module - INFO -    estado: None
2025-10-26 08:37:26,810 - server_module - INFO -    nota: None
2025-10-26 08:37:26,810 - server_module - INFO -    usuario: None
2025-10-26 08:37:26,810 - server_module - INFO -    fecha_conversion: None
2025-10-26 08:37:26,810 - server_module - INFO - ================================================================================
2025-10-26 08:37:27,373 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:27,710 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:27,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:37:27,923 - server_module - INFO - üì§ RESPUESTA update_client: {'success': False, 'error': "Cliente con ID 'tEbHFy' no encontrado"}
2025-10-26 08:37:27,924 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:37:27,924 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f454f080>
2025-10-26 08:37:27,925 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:37:27,925 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:37:27,932 - server_module - INFO - ================================================================================
2025-10-26 08:37:27,933 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:37:27,933 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:37:27,933 - server_module - INFO -    correo: None
2025-10-26 08:37:27,934 - server_module - INFO -    usuario: None
2025-10-26 08:37:27,934 - server_module - INFO - ================================================================================
2025-10-26 08:37:28,174 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:28,397 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:28,735 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:37:28,736 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:37:28,738 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:28,738 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:37:28,738 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":false,\\"error\\":\\"Cliente con ID \'tEbHFy\' no encontrado\\"}"}],"structuredContent":{"success":false,"error":"Cliente con ID \'tEbHFy\' no encontrado"},"isError":false}}\r\n\r\n'
2025-10-26 08:37:28,739 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:28,739 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:37:28,739 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:28,740 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:30,896 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:30,897 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:37:54,541 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:37:54,541 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: ac3dcc59f24e479c8fc8c1d0222fb567
2025-10-26 08:37:54,548 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:54,548 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:37:54,549 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:55,154 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:55,154 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:37:55,494 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:55,733 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:55,734 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4569bb0>
2025-10-26 08:37:55,735 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:37:55,735 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:37:55,735 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:37:55,736 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:55,736 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:37:55,736 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:37:57,612 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:37:57,613 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f452e6f0>
2025-10-26 08:37:57,613 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:37:57,614 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:37:57,618 - server_module - INFO - ================================================================================
2025-10-26 08:37:57,618 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:37:57,619 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:37:57,619 - server_module - INFO -    correo: None
2025-10-26 08:37:57,619 - server_module - INFO -    usuario: None
2025-10-26 08:37:57,619 - server_module - INFO - ================================================================================
2025-10-26 08:37:57,891 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:58,094 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:37:58,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:37:58,435 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:37:58,436 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:37:58,437 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:37:58,438 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:37:58,439 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:38:00,376 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:38:00,379 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4569670>
2025-10-26 08:38:00,379 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:38:00,379 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:38:00,398 - server_module - INFO - ================================================================================
2025-10-26 08:38:00,399 - server_module - INFO - ‚ú® LLAMADA A create_client
2025-10-26 08:38:00,399 - server_module - INFO -    nombre: Fernando
2025-10-26 08:38:00,399 - server_module - INFO -    canal: whatsapp
2025-10-26 08:38:00,399 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:38:00,399 - server_module - INFO -    correo: fordezdeveloper2@gmail.com
2025-10-26 08:38:00,400 - server_module - INFO -    nota: None
2025-10-26 08:38:00,400 - server_module - INFO -    usuario: Forde
2025-10-26 08:38:00,400 - server_module - INFO - ================================================================================
2025-10-26 08:38:00,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:38:00,887 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:38:01,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:38:01,708 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21A4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:01,980 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21B4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:02,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21C4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:02,472 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21D4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:02,673 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21E4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:02,885 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21F4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:03,091 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21G4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:03,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21H4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:03,565 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21I4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:03,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21J4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:04,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21K4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 08:38:04,062 - server_module - INFO - üì§ RESPUESTA create_client: {'success': True, 'client_id': 'QVo9CC', 'nombre': 'Fernando', 'canal': 'whatsapp', 'message': 'Cliente creado exitosamente'}
2025-10-26 08:38:04,063 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:38:04,064 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:38:04,064 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":true,\\"client_id\\":\\"QVo9CC\\",\\"nombre\\":\\"Fernando\\",\\"canal\\":\\"whatsapp\\",\\"message\\":\\"Cliente creado exitosamente\\"}"}],"structuredContent":{"success":true,"client_id":"QVo9CC","nombre":"Fernando","canal":"whatsapp","message":"Cliente creado exitosamente"},"isError":false}}\r\n\r\n'
2025-10-26 08:38:04,065 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:38:06,359 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:38:06,360 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 08:56:28,973 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 08:56:28,973 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: 875edb724ba04b2ca83a591a746eec33
2025-10-26 08:56:28,980 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:56:28,981 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 08:56:28,982 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:56:29,707 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:56:29,708 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 08:56:30,049 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:56:30,271 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:56:30,273 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4569370>
2025-10-26 08:56:30,274 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 08:56:30,274 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 08:56:30,274 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:56:30,275 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:56:30,275 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 08:56:30,276 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:56:32,652 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 08:56:32,654 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x7578f4387230>
2025-10-26 08:56:32,654 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 08:56:32,655 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 08:56:32,661 - server_module - INFO - ================================================================================
2025-10-26 08:56:32,662 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 08:56:32,662 - server_module - INFO -    telefono: +573146964611
2025-10-26 08:56:32,662 - server_module - INFO -    correo: None
2025-10-26 08:56:32,662 - server_module - INFO -    usuario: None
2025-10-26 08:56:32,662 - server_module - INFO - ================================================================================
2025-10-26 08:56:32,663 - urllib3.connectionpool - DEBUG - Resetting dropped connection: sheets.googleapis.com
2025-10-26 08:56:33,354 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:56:33,690 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 08:56:33,883 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 08:56:33,884 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': False, 'client_id': None, 'nombre': None, 'telefono': None, 'correo': None, 'tipo': None, 'estado': None, 'canal': None, 'nota': None, 'usuario': None, 'matched_by': None}
2025-10-26 08:56:33,888 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 08:56:33,889 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 08:56:33,889 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":false,\\"client_id\\":null,\\"nombre\\":null,\\"telefono\\":null,\\"correo\\":null,\\"tipo\\":null,\\"estado\\":null,\\"canal\\":null,\\"nota\\":null,\\"usuario\\":null,\\"matched_by\\":null}"}],"structuredContent":{"exists":false,"client_id":null,"nombre":null,"telefono":null,"correo":null,"tipo":null,"estado":null,"canal":null,"nota":null,"usuario":null,"matched_by":null},"isError":false}}\r\n\r\n'
2025-10-26 08:56:33,890 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:56:35,578 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 08:56:35,578 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 09:05:15,099 - mcp.server.streamable_http_manager - INFO - StreamableHTTP session manager shutting down
2025-10-26 09:08:17,135 - mcp.server.lowlevel.server - DEBUG - Initializing server 'CRM Server'
2025-10-26 09:08:17,135 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListToolsRequest
2025-10-26 09:08:17,135 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListResourcesRequest
2025-10-26 09:08:17,136 - mcp.server.lowlevel.server - DEBUG - Registering handler for ListResourceTemplatesRequest
2025-10-26 09:08:17,136 - mcp.server.lowlevel.server - DEBUG - Registering handler for PromptListRequest
2025-10-26 09:08:17,136 - mcp.server.lowlevel.server - DEBUG - Registering handler for CallToolRequest
2025-10-26 09:08:17,136 - mcp.server.lowlevel.server - DEBUG - Registering handler for ReadResourceRequest
2025-10-26 09:08:17,136 - mcp.server.lowlevel.server - DEBUG - Registering handler for GetPromptRequest
2025-10-26 09:08:17,201 - mcp.server.streamable_http_manager - INFO - StreamableHTTP session manager started
2025-10-26 09:08:37,573 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 09:08:37,574 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: bf9a776bf20040708eea5b7aef27d4c9
2025-10-26 09:08:37,586 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:08:37,587 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 09:08:37,589 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:08:38,198 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:08:38,199 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 09:08:38,540 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:08:38,767 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:08:38,770 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x72d5ef5b7b90>
2025-10-26 09:08:38,770 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 09:08:38,771 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 09:08:38,772 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 09:08:38,772 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:08:38,773 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 09:08:38,774 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:08:40,304 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:08:40,306 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x72d5ef5d2f30>
2025-10-26 09:08:40,308 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 09:08:40,308 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 09:08:40,320 - server_module - INFO - ================================================================================
2025-10-26 09:08:40,320 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 09:08:40,320 - server_module - INFO -    telefono: +573146964611
2025-10-26 09:08:40,320 - server_module - INFO -    correo: None
2025-10-26 09:08:40,320 - server_module - INFO -    usuario: None
2025-10-26 09:08:40,320 - server_module - INFO - ================================================================================
2025-10-26 09:08:40,329 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-10-26 09:08:40,743 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-10-26 09:08:40,749 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-10-26 09:08:41,475 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:08:41,781 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:08:42,089 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 09:08:42,090 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': True, 'client_id': 'QVo9CC', 'nombre': 'Fernando', 'telefono': 573146964611, 'correo': 'fordezdeveloper2@gmail.com', 'tipo': 'Lead', 'estado': 'Nuevo', 'canal': 'whatsapp', 'nota': '', 'usuario': 'Forde', 'matched_by': 'telefono'}
2025-10-26 09:08:42,092 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 09:08:42,092 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:08:42,093 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":true,\\"client_id\\":\\"QVo9CC\\",\\"nombre\\":\\"Fernando\\",\\"telefono\\":573146964611,\\"correo\\":\\"fordezdeveloper2@gmail.com\\",\\"tipo\\":\\"Lead\\",\\"estado\\":\\"Nuevo\\",\\"canal\\":\\"whatsapp\\",\\"nota\\":\\"\\",\\"usuario\\":\\"Forde\\",\\"matched_by\\":\\"telefono\\"}"}],"structuredContent":{"exists":true,"client_id":"QVo9CC","nombre":"Fernando","telefono":573146964611,"correo":"fordezdeveloper2@gmail.com","tipo":"Lead","estado":"Nuevo","canal":"whatsapp","nota":"","usuario":"Forde","matched_by":"telefono"},"isError":false}}\r\n\r\n'
2025-10-26 09:08:42,093 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:08:43,379 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:08:43,379 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 09:11:10,572 - mcp.server.streamable_http_manager - DEBUG - Creating new transport
2025-10-26 09:11:10,572 - mcp.server.streamable_http_manager - INFO - Created new transport with session ID: ced6321917974041a3c963faf2c99c5e
2025-10-26 09:11:10,579 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:11:10,579 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2025-03-26","capabilities":{"experimental":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"CRM Server","version":"1.16.0"}}}\r\n\r\n'
2025-10-26 09:11:10,580 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:11:11,386 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:11:11,387 - mcp.server.lowlevel.server - DEBUG - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-26 09:11:11,724 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:11:11,945 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:11:11,947 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x72d5ef604290>
2025-10-26 09:11:11,947 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-10-26 09:11:11,947 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type ListToolsRequest
2025-10-26 09:11:11,948 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 09:11:11,948 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:11:11,949 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"verify_client","description":"Verifica si un cliente existe en el CRM.\\nBusca por tel\xc3\xa9fono, correo o usuario. Al menos uno debe proporcionarse.\\n\\nArgs:\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads (ej: +5491123456789)\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    usuario: Usuario o agente asignado","inputSchema":{"properties":{"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_client","description":"Crea un nuevo cliente (lead) en el CRM con ID autogenerado.\\n\\nArgs:\\n    nombre: Nombre completo del cliente (REQUERIDO)\\n    canal: Canal de origen - debe ser \'whatsapp\' o \'web\' (REQUERIDO)\\n    telefono: N\xc3\xbamero de tel\xc3\xa9fono con c\xc3\xb3digo de pa\xc3\xads\\n    correo: Correo electr\xc3\xb3nico del cliente\\n    nota: Observaciones iniciales sobre el lead\\n    usuario: Usuario o agente que registra el lead","inputSchema":{"properties":{"nombre":{"type":"string"},"canal":{"type":"string"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["nombre","canal"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"update_client","description":"Actualiza los datos de un cliente existente.\\nSolo actualiza los campos proporcionados.\\n\\nArgs:\\n    client_id: ID \xc3\xbanico del cliente (obtenido de verify_client) - REQUERIDO\\n    nombre: Actualizar nombre del cliente\\n    telefono: Actualizar n\xc3\xbamero de tel\xc3\xa9fono\\n    correo: Actualizar correo electr\xc3\xb3nico\\n    tipo: Tipo de cliente (Lead o Cliente)\\n    estado: Estado del lead (Nuevo, Contactado, Calificado, Negociaci\xc3\xb3n, Ganado, Perdido)\\n    nota: Notas de seguimiento o actualizaci\xc3\xb3n\\n    usuario: Reasignar a otro usuario o agente\\n    fecha_conversion: Fecha de conversi\xc3\xb3n a cliente (formato: YYYY-MM-DD HH:MM:SS)","inputSchema":{"properties":{"client_id":{"type":"string"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"correo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"tipo":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"estado":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"nota":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"fecha_conversion":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["client_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}\r\n\r\n'
2025-10-26 09:11:11,949 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:11:13,733 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:11:13,735 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x72d5ef604200>
2025-10-26 09:11:13,735 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 09:11:13,735 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 09:11:13,745 - server_module - INFO - ================================================================================
2025-10-26 09:11:13,745 - server_module - INFO - üîç LLAMADA A verify_client
2025-10-26 09:11:13,745 - server_module - INFO -    telefono: +573146964611
2025-10-26 09:11:13,745 - server_module - INFO -    correo: None
2025-10-26 09:11:13,745 - server_module - INFO -    usuario: None
2025-10-26 09:11:13,745 - server_module - INFO - ================================================================================
2025-10-26 09:11:14,252 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:11:14,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:11:14,970 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 09:11:14,971 - server_module - INFO - üì§ RESPUESTA verify_client: {'exists': True, 'client_id': 'QVo9CC', 'nombre': 'Fernando', 'telefono': 573146964611, 'correo': 'fordezdeveloper2@gmail.com', 'tipo': 'Lead', 'estado': 'Nuevo', 'canal': 'whatsapp', 'nota': '', 'usuario': 'Forde', 'matched_by': 'telefono'}
2025-10-26 09:11:14,972 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 09:11:14,973 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:11:14,973 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"{\\"exists\\":true,\\"client_id\\":\\"QVo9CC\\",\\"nombre\\":\\"Fernando\\",\\"telefono\\":573146964611,\\"correo\\":\\"fordezdeveloper2@gmail.com\\",\\"tipo\\":\\"Lead\\",\\"estado\\":\\"Nuevo\\",\\"canal\\":\\"whatsapp\\",\\"nota\\":\\"\\",\\"usuario\\":\\"Forde\\",\\"matched_by\\":\\"telefono\\"}"}],"structuredContent":{"exists":true,"client_id":"QVo9CC","nombre":"Fernando","telefono":573146964611,"correo":"fordezdeveloper2@gmail.com","tipo":"Lead","estado":"Nuevo","canal":"whatsapp","nota":"","usuario":"Forde","matched_by":"telefono"},"isError":false}}\r\n\r\n'
2025-10-26 09:11:14,974 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:11:16,412 - mcp.server.streamable_http_manager - DEBUG - Session already exists, handling request directly
2025-10-26 09:11:16,415 - mcp.server.lowlevel.server - DEBUG - Received message: <mcp.shared.session.RequestResponder object at 0x72d5ef61f1a0>
2025-10-26 09:11:16,416 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-10-26 09:11:16,416 - mcp.server.lowlevel.server - DEBUG - Dispatching request of type CallToolRequest
2025-10-26 09:11:16,434 - server_module - INFO - ================================================================================
2025-10-26 09:11:16,435 - server_module - INFO - üîÑ LLAMADA A update_client
2025-10-26 09:11:16,435 - server_module - INFO -    client_id: QVo9CC
2025-10-26 09:11:16,435 - server_module - INFO -    nombre: Jaime
2025-10-26 09:11:16,435 - server_module - INFO -    telefono: None
2025-10-26 09:11:16,435 - server_module - INFO -    correo: None
2025-10-26 09:11:16,435 - server_module - INFO -    tipo: None
2025-10-26 09:11:16,435 - server_module - INFO -    estado: None
2025-10-26 09:11:16,435 - server_module - INFO -    nota: None
2025-10-26 09:11:16,435 - server_module - INFO -    usuario: None
2025-10-26 09:11:16,435 - server_module - INFO -    fecha_conversion: None
2025-10-26 09:11:16,435 - server_module - INFO - ================================================================================
2025-10-26 09:11:16,777 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:11:17,136 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E?includeGridData=false HTTP/1.1" 200 None
2025-10-26 09:11:17,427 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27 HTTP/1.1" 200 None
2025-10-26 09:11:17,733 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1evcXPBlNMgqFAJyp2N-T3WpnQPrH3LU2OrQfT2jnr5E/values/%27Lead%27%21B4?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-10-26 09:11:17,734 - server_module - INFO - üì§ RESPUESTA update_client: {'success': True, 'client_id': 'QVo9CC', 'updated_fields': ['Nombre'], 'message': 'Cliente actualizado: 1 campos modificados'}
2025-10-26 09:11:17,736 - mcp.server.lowlevel.server - DEBUG - Response sent
2025-10-26 09:11:17,737 - mcp.server.streamable_http - DEBUG - Closing SSE writer
2025-10-26 09:11:17,737 - sse_starlette.sse - DEBUG - chunk: b'event: message\r\ndata: {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"{\\"success\\":true,\\"client_id\\":\\"QVo9CC\\",\\"updated_fields\\":[\\"Nombre\\"],\\"message\\":\\"Cliente actualizado: 1 campos modificados\\"}"}],"structuredContent":{"success":true,"client_id":"QVo9CC","updated_fields":["Nombre"],"message":"Cliente actualizado: 1 campos modificados"},"isError":false}}\r\n\r\n'
2025-10-26 09:11:17,738 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:11:19,580 - sse_starlette.sse - DEBUG - Got event: http.disconnect. Stop streaming.
2025-10-26 09:11:19,581 - mcp.server.streamable_http - DEBUG - Closing standalone SSE writer
2025-10-26 09:17:45,121 - mcp.server.streamable_http_manager - INFO - StreamableHTTP session manager shutting down
